
Cholesky Decomposition
```{r}

X = matrix(0, nrow = 2, ncol = 1000)
A = rbind(c(1,1,0), c(1,0,1))
for (i in 1:1000){
  Z = rnorm(3)
  X[,i] = A %*% Z
}
hist(X[1,])
plot(X[1,], X[2,], xlim = c(-5,5), ylim = c(-5,5))
```
```{r}
# mv_cd = function(mu, sigma){
#   l = t(chol(sigma))
#   r = length(mu)
#   z = rnorm(r)
#   return (l %*% Z + mu)
# }
# 
# # X1 = matrix(0, nrow = 2, ncol = 1000)
# # for (i in 1:1000){
# #   X1[,i] = mv_cd(c(0,0),rbind(c(1.0, 0.9),c(0.9,1.0)))
# # }
# 
# hist(X1[1,])
# plot(X1[1,], X2[2,])
```

The Gibbs Sampler
```{r}
px_given_y = function(y, mus, sigmas, n){
  mu = mus[1] + sigmas[0][1] / sigmas[0][0] * (y - mus[1])
  sigma = (sigmas[0][0] - sigmas[1][0]) / (sigmas[1][1] * sigmas[1][0])
  return (rnorm(n, mu, sigma))
}

py_given_x = function(x, mus, sigmas, n){
  mu = mus[1] + sigmas[0][1] / sigmas[1][1] * (x - mus[0])
  sigma = (sigmas[1][1] - sigmas[0][1]) / (sigmas[0][0] * sigmas[0][1])
  return (rnorm(n, mu, sigma)) 
}

gibbs_sampler = function(mus, sigma, n = 5000){
  samples = list(rep(0, n))
  y = mus[1]
  for (i in range(n)){
    x = px_given_y(y, mus, sigmas, n)
    y = py_given_x(x, mus, sigmas, n)
    samples[i] = c(x, y)
    return (samples)
  }
}

mus = c(5, 5)
sigmas = c(c(1, .9), c(.9, 1))
s = gibbs_sampler(mus, sigmas)

#use for loop for zip
burn = 100
```





